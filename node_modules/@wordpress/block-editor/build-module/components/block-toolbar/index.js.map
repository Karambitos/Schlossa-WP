{"version":3,"sources":["@wordpress/block-editor/src/components/block-toolbar/index.js"],"names":["classnames","useSelect","useDispatch","useRef","useViewportMatch","getBlockType","hasBlockSupport","BlockMover","BlockParentSelector","BlockSwitcher","BlockControls","BlockFormatControls","BlockSettingsMenu","BlockDraggable","useShowMoversGestures","BlockToolbar","hideDragHandle","select","getBlockName","getBlockMode","getSelectedBlockClientIds","isBlockValid","getBlockRootClientId","getSettings","selectedBlockClientIds","selectedBlockClientId","blockRootClientId","blockClientIds","blockClientId","blockType","hasFixedToolbar","rootClientId","isValid","every","id","isVisual","toggleBlockHighlight","nodeRef","ref","onChange","isFocused","showMovers","showMoversGestures","gestures","displayHeaderToolbar","shouldShowMovers","length","shouldShowVisualToolbar","isMultiToolbar","classes","isDraggable","onDraggableStart","onDraggableEnd"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useRef } from '@wordpress/element';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { getBlockType, hasBlockSupport } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport BlockMover from '../block-mover';\nimport BlockParentSelector from '../block-parent-selector';\nimport BlockSwitcher from '../block-switcher';\nimport BlockControls from '../block-controls';\nimport BlockFormatControls from '../block-format-controls';\nimport BlockSettingsMenu from '../block-settings-menu';\nimport BlockDraggable from '../block-draggable';\nimport { useShowMoversGestures } from './utils';\n\nexport default function BlockToolbar( { hideDragHandle } ) {\n\tconst {\n\t\tblockClientIds,\n\t\tblockClientId,\n\t\tblockType,\n\t\thasFixedToolbar,\n\t\tisValid,\n\t\tisVisual,\n\t} = useSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetBlockName,\n\t\t\tgetBlockMode,\n\t\t\tgetSelectedBlockClientIds,\n\t\t\tisBlockValid,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetSettings,\n\t\t} = select( 'core/block-editor' );\n\t\tconst selectedBlockClientIds = getSelectedBlockClientIds();\n\t\tconst selectedBlockClientId = selectedBlockClientIds[ 0 ];\n\t\tconst blockRootClientId = getBlockRootClientId( selectedBlockClientId );\n\n\t\treturn {\n\t\t\tblockClientIds: selectedBlockClientIds,\n\t\t\tblockClientId: selectedBlockClientId,\n\t\t\tblockType:\n\t\t\t\tselectedBlockClientId &&\n\t\t\t\tgetBlockType( getBlockName( selectedBlockClientId ) ),\n\t\t\thasFixedToolbar: getSettings().hasFixedToolbar,\n\t\t\trootClientId: blockRootClientId,\n\t\t\tisValid: selectedBlockClientIds.every( ( id ) =>\n\t\t\t\tisBlockValid( id )\n\t\t\t),\n\t\t\tisVisual: selectedBlockClientIds.every(\n\t\t\t\t( id ) => getBlockMode( id ) === 'visual'\n\t\t\t),\n\t\t};\n\t}, [] );\n\n\tconst { toggleBlockHighlight } = useDispatch( 'core/block-editor' );\n\tconst nodeRef = useRef();\n\n\tconst { showMovers, gestures: showMoversGestures } = useShowMoversGestures(\n\t\t{\n\t\t\tref: nodeRef,\n\t\t\tonChange( isFocused ) {\n\t\t\t\ttoggleBlockHighlight( blockClientId, isFocused );\n\t\t\t},\n\t\t}\n\t);\n\n\tconst displayHeaderToolbar =\n\t\tuseViewportMatch( 'medium', '<' ) || hasFixedToolbar;\n\n\tif ( blockType ) {\n\t\tif ( ! hasBlockSupport( blockType, '__experimentalToolbar', true ) ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tconst shouldShowMovers = displayHeaderToolbar || showMovers;\n\n\tif ( blockClientIds.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tconst shouldShowVisualToolbar = isValid && isVisual;\n\tconst isMultiToolbar = blockClientIds.length > 1;\n\n\tconst classes = classnames(\n\t\t'block-editor-block-toolbar',\n\t\tshouldShowMovers && 'is-showing-movers'\n\t);\n\n\treturn (\n\t\t<div className={ classes }>\n\t\t\t<div\n\t\t\t\tclassName=\"block-editor-block-toolbar__mover-switcher-container\"\n\t\t\t\tref={ nodeRef }\n\t\t\t\t{ ...showMoversGestures }\n\t\t\t>\n\t\t\t\t{ ! isMultiToolbar && (\n\t\t\t\t\t<div className=\"block-editor-block-toolbar__block-parent-selector-wrapper\">\n\t\t\t\t\t\t<BlockParentSelector clientIds={ blockClientIds } />\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\n\t\t\t\t{ ( shouldShowVisualToolbar || isMultiToolbar ) && (\n\t\t\t\t\t<BlockDraggable\n\t\t\t\t\t\tclientIds={ blockClientIds }\n\t\t\t\t\t\tcloneClassname=\"block-editor-block-toolbar__drag-clone\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ ( {\n\t\t\t\t\t\t\tisDraggable,\n\t\t\t\t\t\t\tonDraggableStart,\n\t\t\t\t\t\t\tonDraggableEnd,\n\t\t\t\t\t\t} ) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"block-editor-block-toolbar__block-switcher-wrapper\"\n\t\t\t\t\t\t\t\tdraggable={ isDraggable && ! hideDragHandle }\n\t\t\t\t\t\t\t\tonDragStart={ onDraggableStart }\n\t\t\t\t\t\t\t\tonDragEnd={ onDraggableEnd }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockSwitcher clientIds={ blockClientIds } />\n\t\t\t\t\t\t\t\t<BlockMover clientIds={ blockClientIds } />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</BlockDraggable>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t\t{ shouldShowVisualToolbar && (\n\t\t\t\t<>\n\t\t\t\t\t<BlockControls.Slot\n\t\t\t\t\t\tbubblesVirtually\n\t\t\t\t\t\tclassName=\"block-editor-block-toolbar__slot\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BlockFormatControls.Slot\n\t\t\t\t\t\tbubblesVirtually\n\t\t\t\t\t\tclassName=\"block-editor-block-toolbar__slot\"\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t) }\n\t\t\t<BlockSettingsMenu clientIds={ blockClientIds } />\n\t\t</div>\n\t);\n}\n"]}